"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[985],{7232(e,t,n){n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"tutorial/extragzt","title":"Extracting Tabular Data","description":"Values: Python Script, Tabular Data, Pipeline","source":"@site/docs/tutorial/extragzt.md","sourceDirName":"tutorial","slug":"/tutorial/extragzt","permalink":"/opengin-ingestion/docs/tutorial/extragzt","draft":false,"unlisted":false,"editUrl":"https://github.com/LDFLK/opengin-ingestion/tree/main/docs/docs/tutorial/extragzt.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Tutorials","permalink":"/opengin-ingestion/docs/category/tutorials"}}');var a=n(4848),r=n(8453);const s={sidebar_position:1},l="Extracting Tabular Data",o={},c=[{value:"Overview",id:"overview",level:2},{value:"The Code Explained",id:"the-code-explained",level:2},{value:"1. Setup and Initialization",id:"1-setup-and-initialization",level:3},{value:"2. Defining the Extraction Prompt",id:"2-defining-the-extraction-prompt",level:3},{value:"3. Running the Pipeline",id:"3-running-the-pipeline",level:3},{value:"4. Retrieving Results",id:"4-retrieving-results",level:3},{value:"Running the Example",id:"running-the-example",level:2},{value:"Example Output",id:"example-output",level:3},{value:"Extraction with Metadata",id:"extraction-with-metadata",level:2},{value:"1. Define the Schema",id:"1-define-the-schema",level:3},{value:"2. Run with Schema",id:"2-run-with-schema",level:3},{value:"Generated Files",id:"generated-files",level:2}];function d(e){const t={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"extracting-tabular-data",children:"Extracting Tabular Data"})}),"\n",(0,a.jsxs)(t.p,{children:["Values: ",(0,a.jsx)(t.strong,{children:"Python Script"}),", ",(0,a.jsx)(t.strong,{children:"Tabular Data"}),", ",(0,a.jsx)(t.strong,{children:"Pipeline"})]}),"\n",(0,a.jsxs)(t.p,{children:["This tutorial guides you through using the ",(0,a.jsx)(t.code,{children:"tabular_extragzt_extract_sample.py"})," example script. This script demonstrates how to utilize the ",(0,a.jsx)(t.code,{children:"opengin.tracer"})," library to automate the extraction of tabular data from PDF documents."]}),"\n",(0,a.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsxs)(t.p,{children:["The example script is located at ",(0,a.jsx)(t.code,{children:"python/examples/extragzt/tabular_extragzt_extract_sample.py"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"It performs the following high-level actions:"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Initializes"})," a pipeline with the Orchestrator (Agent 0)."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Scans"})," and extracts data from each page using the Scanner (Agent 1)."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Aggregates"})," the results using the Aggregator (Agent 2)."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Exports"})," the data using the Exporter (Agent 3)."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"the-code-explained",children:"The Code Explained"}),"\n",(0,a.jsx)(t.p,{children:"Here's a breakdown of the key components in the script."}),"\n",(0,a.jsx)(t.h3,{id:"1-setup-and-initialization",children:"1. Setup and Initialization"}),"\n",(0,a.jsxs)(t.p,{children:["The script starts by initializing the ",(0,a.jsx)(t.code,{children:"Agent0"})," orchestrator. This agent manages the entire lifecycle of the pipeline."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from opengin.tracer.agents.orchestrator import Agent0\n\ndef perform_extraction(file_path: str, prompt_file: str) -> None:\n    # Initialize Agent0 Orchestrator\n    agent0 = Agent0()\n    pipeline_name = "example_extragzt_run"\n    \n    # Start Pipeline\n    # creates the directory structure and generates a run_id\n    run_id, metadata = agent0.create_pipeline(\n        pipeline_name,\n        file_path,\n        os.path.basename(file_path)\n    )\n'})}),"\n",(0,a.jsx)(t.h3,{id:"2-defining-the-extraction-prompt",children:"2. Defining the Extraction Prompt"}),"\n",(0,a.jsxs)(t.p,{children:["The core logic of ",(0,a.jsx)(t.em,{children:"what"})," to extract is now separated into a text file (e.g., ",(0,a.jsx)(t.code,{children:"prompt.txt"}),"). This allows for easier iteration on prompts without modifying the code."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:"**Objective:** Extract all tables from the provided document.\n\n**Instructions:**\n1. **Identify Minister:** Locate the name of the minister...\n2. **Strict Row Alignment:** Each column generally has items...\n...\n"})}),"\n",(0,a.jsx)(t.p,{children:"The script reads this file during execution:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'    with open(prompt_file, "r") as f:\n        extraction_prompt = f.read()\n'})}),"\n",(0,a.jsx)(t.h3,{id:"3-running-the-pipeline",children:"3. Running the Pipeline"}),"\n",(0,a.jsxs)(t.p,{children:["The actual processing is triggered by a single call to ",(0,a.jsx)(t.code,{children:"run_pipeline"}),". This method coordinates the hand-off between Agent 1, Agent 2, and Agent 3."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"    # Run Extraction\n    agent0.run_pipeline(pipeline_name, run_id, extraction_prompt)\n"})}),"\n",(0,a.jsx)(t.h3,{id:"4-retrieving-results",children:"4. Retrieving Results"}),"\n",(0,a.jsx)(t.p,{children:"Once the pipeline completes, the script reads the aggregated results from the file system."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'    # Retrieve Results\n    fs_manager = agent0.fs_manager\n    aggregated_path = fs_manager.get_aggregated_results_path(pipeline_name, run_id)\n\n    with open(aggregated_path, "r") as f:\n        tables = json.load(f)\n'})}),"\n",(0,a.jsx)(t.h2,{id:"running-the-example",children:"Running the Example"}),"\n",(0,a.jsx)(t.p,{children:"To run the example, use the following command from the root of the project:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"python python/examples/extragzt/tabular_extragzt_extract_sample.py <path_to_pdf> <path_to_prompt_txt>\n"})}),"\n",(0,a.jsx)(t.p,{children:"For the provided example prompt:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"python python/examples/extragzt/tabular_extragzt_extract_sample.py python/data/simple.pdf python/examples/extragzt/prompt.txt\n"})}),"\n",(0,a.jsx)(t.h3,{id:"example-output",children:"Example Output"}),"\n",(0,a.jsx)(t.p,{children:"When you run the script, you will see logs indicating the progress of each agent:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:"INFO - Agent 0: Starting pipeline 'example_extragzt_run' run 'uuid...'\nINFO - Agent 1: Starting scanning...\nINFO - Agent 1: Processing page 1/5\n...\nINFO - Agent 2: Triggering Aggregation...\nINFO - Agent 3: Triggering Export...\n"})}),"\n",(0,a.jsx)(t.p,{children:"Finally, the script prints a summary of the extracted tables:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:"--- Extracted 3 Tables ---\nTable ID: minister_table_1\nName:     Minister of Finance\nColumns:  ['Date', 'Description', 'Amount']\nRows:     12 found\n----------------------------------------\n"})}),"\n",(0,a.jsx)(t.h2,{id:"extraction-with-metadata",children:"Extraction with Metadata"}),"\n",(0,a.jsx)(t.p,{children:"You can also extract metadata associated with each table by providing a metadata schema."}),"\n",(0,a.jsx)(t.h3,{id:"1-define-the-schema",children:"1. Define the Schema"}),"\n",(0,a.jsxs)(t.p,{children:["Create a YAML file (e.g., ",(0,a.jsx)(t.code,{children:"metadata.yml"}),") defining the fields you want to extract:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",children:"fields:\n  - name: category\n    description: The category of the data in the table\n    type: string\n  - name: confidence\n    description: Confidence score (0-1) of the extraction\n    type: float\n"})}),"\n",(0,a.jsx)(t.h3,{id:"2-run-with-schema",children:"2. Run with Schema"}),"\n",(0,a.jsxs)(t.p,{children:["Pass the ",(0,a.jsx)(t.code,{children:"--metadata-schema"})," argument to the script:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"python python/examples/extragzt/tabular_extragzt_extract_sample.py <path_to_pdf> <path_to_prompt> --metadata-schema python/examples/extragzt/metadata.yml\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The extracted metadata will be printed to the console and saved as a JSON file (e.g., ",(0,a.jsx)(t.code,{children:"tablename_metadata.json"}),") alongside the CSV output."]}),"\n",(0,a.jsx)(t.h2,{id:"generated-files",children:"Generated Files"}),"\n",(0,a.jsxs)(t.p,{children:["For every run, the tracer creates a dedicated directory structure in ",(0,a.jsx)(t.code,{children:"pipelines/"}),":"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"pipelines/<pipeline_name>/<run_id>/input/"}),": Contains the original PDF and split pages."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"pipelines/<pipeline_name>/<run_id>/intermediate/"}),": Contains JSON files for each individual page extraction."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"pipelines/<pipeline_name>/<run_id>/aggregated/"}),": Contains the consolidated ",(0,a.jsx)(t.code,{children:"tables.json"}),"."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"pipelines/<pipeline_name>/<run_id>/output/"}),": Contains the final exported files (e.g., CSVs)."]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453(e,t,n){n.d(t,{R:()=>s,x:()=>l});var i=n(6540);const a={},r=i.createContext(a);function s(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);